// Code generated by jerky. DO NOT EDIT.

package status

import (
	"github.com/synnaxlabs/x/status/types"
	"github.com/synnaxlabs/x/telem"
	"github.com/vmihailenco/msgpack/v5"
	"google.golang.org/protobuf/proto"
)

// MarshalGorp serializes a Status to bytes using protobuf.
func (m Status) MarshalGorp() ([]byte, error) {
	return proto.Marshal(&types.Status{
		Key: m.Key,
		Name: m.Name,
		Variant: m.Variant,
		Message: m.Message,
		Description: m.Description,
		Time: int64(m.Time),
		Details: m.Details,
	})
}

// UnmarshalGorp deserializes bytes into a Status.
func (m *Status) UnmarshalGorp(data []byte) error {
	var pb types.Status
	if err := proto.Unmarshal(data, &pb); err == nil {
		m.Key = pb.Key
		m.Name = pb.Name
		m.Variant = Variant(pb.Variant)
		m.Message = pb.Message
		m.Description = pb.Description
		m.Time = telem.TimeStamp(pb.Time)
		m.Details = pb.Details
		return nil
	}
	// Fall back to msgpack (legacy format)
	return msgpack.Unmarshal(data, m)
}
