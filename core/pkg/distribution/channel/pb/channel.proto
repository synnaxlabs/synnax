// Code generated by oracle. DO NOT EDIT.

syntax = "proto3";

package distribution.channel.pb;

import "x/go/control/pb/control.proto";

option go_package = "github.com/synnaxlabs/synnax/pkg/distribution/channel/pb";

// OperationType is the type of aggregation operation to apply to channel data over time.
enum OperationType {
  OPERATION_TYPE_MIN = 0;
  OPERATION_TYPE_MAX = 1;
  OPERATION_TYPE_AVG = 2;
  OPERATION_TYPE_NONE = 3;
}

// Operation defines an aggregation operation applied to channel data. Operations
// calculate min, max, or average values over a time duration or triggered
// by a reset channel.
message Operation {
  // type is the aggregation operation type: min, max, avg, or none.
  OperationType type = 1;
  // reset_channel is the channel key that triggers reset of the aggregation. If 0,
  // duration-based reset is used.
  uint32 reset_channel = 2;
  // duration is the time window for aggregation when reset_channel is 0.
  int64 duration = 3;
}

// Channel is an internal representation of a channel containing all storage and
// distribution metadata. This type is used internally by the server;
// clients should use APIChannel instead.
message Channel {
  // name is the human-readable channel name.
  string name = 1;
  // leaseholder is the cluster node that holds the lease for this channel and is
  // authorized to accept writes.
  uint32 leaseholder = 2;
  // data_type is the data type of samples stored in this channel.
  string data_type = 3;
  // is_index is true if this channel is an index channel. Index channels must
  // have int64 values (TIMESTAMP data type) written in ascending order,
  // and are most commonly unix nanosecond timestamps.
  bool is_index = 4;
  // local_key is the locally-unique portion of this channel's key.
  uint32 local_key = 5;
  // local_index is the channel used to index this channel's values, associating
  // each value with a timestamp. If zero, the channel's data will be
  // indexed using its rate.
  uint32 local_index = 6;
  // virtual is true if this channel does not persist data and is used only for
  // streaming.
  bool virtual = 7;
  // concurrency sets the policy for concurrent writes to the channel's data. Only
  // virtual channels can have a policy of shared concurrency.
  .x.control.pb.Concurrency concurrency = 8;
  // internal is true if this is a system channel hidden from normal user queries.
  bool internal = 9;
  // operations contains aggregation operations applied to this channel's data.
  repeated Operation operations = 10;
  // expression is an Arc expression for calculated channels. If set, the channel
  // is automatically configured as virtual.
  string expression = 11;
}
