// Code generated by relapse/gen; DO NOT EDIT.

package schematic

// Action type constants
const (
	ActionAddNode = "add_node"
	ActionSetNodeProps = "set_node_props"
	ActionSetNodePosition = "set_node_position"
	ActionRemoveNode = "remove_node"
	ActionRemoveEdge = "remove_edge"
)

// Action is a discriminated union for all Schematic mutations.
// The Type field determines which payload field is valid.
type Action struct {
	Type string `json:"type"`

	// Payload fields (only one is valid based on Type)
	AddNode *AddNode `json:"add_node,omitempty"`
	SetNodeProps *SetNodeProps `json:"set_node_props,omitempty"`
	SetNodePosition *SetNodePosition `json:"set_node_position,omitempty"`
	RemoveNode *RemoveNode `json:"remove_node,omitempty"`
	RemoveEdge *RemoveEdge `json:"remove_edge,omitempty"`
}

// Reduce applies this action to a state and returns the new state.
// This uses the Type discriminator for compile-time type safety.
func (a Action) Reduce(state Schematic) (Schematic, error) {
	switch a.Type {
	case ActionAddNode:
		if a.AddNode == nil {
			return state, nil
		}
		return a.AddNode.Handle(state)
	case ActionSetNodeProps:
		if a.SetNodeProps == nil {
			return state, nil
		}
		return a.SetNodeProps.Handle(state)
	case ActionSetNodePosition:
		if a.SetNodePosition == nil {
			return state, nil
		}
		return a.SetNodePosition.Handle(state)
	case ActionRemoveNode:
		if a.RemoveNode == nil {
			return state, nil
		}
		return a.RemoveNode.Handle(state)
	case ActionRemoveEdge:
		if a.RemoveEdge == nil {
			return state, nil
		}
		return a.RemoveEdge.Handle(state)
	default:
		// Unknown actions are ignored
		return state, nil
	}
}

// Action constructors for type-safe creation

// NewAddNodeAction creates a add_node action.
func NewAddNodeAction(payload AddNode) Action {
	return Action{
		Type: ActionAddNode,
		AddNode: &payload,
	}
}

// NewSetNodePropsAction creates a set_node_props action.
func NewSetNodePropsAction(payload SetNodeProps) Action {
	return Action{
		Type: ActionSetNodeProps,
		SetNodeProps: &payload,
	}
}

// NewSetNodePositionAction creates a set_node_position action.
func NewSetNodePositionAction(payload SetNodePosition) Action {
	return Action{
		Type: ActionSetNodePosition,
		SetNodePosition: &payload,
	}
}

// NewRemoveNodeAction creates a remove_node action.
func NewRemoveNodeAction(payload RemoveNode) Action {
	return Action{
		Type: ActionRemoveNode,
		RemoveNode: &payload,
	}
}

// NewRemoveEdgeAction creates a remove_edge action.
func NewRemoveEdgeAction(payload RemoveEdge) Action {
	return Action{
		Type: ActionRemoveEdge,
		RemoveEdge: &payload,
	}
}

