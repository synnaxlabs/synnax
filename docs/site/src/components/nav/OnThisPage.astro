---
import Feedback from "@/components/feedback/Feedback.astro";
import { OnThisPage as OTP } from "@/components/nav/OnThisPage";
import { Icon, Divider, Text, Flex } from "@synnaxlabs/pluto";
const props = Astro.props;
---

<Flex.Box el="nav" className="on-this-page" gap="medium">
    <Flex.Box direction="y" gap={2} className="on-this-page__header">
        <Text.Text level="h5">
            <Icon.Log style={{ transform: "scale(0.8)" }} />
            On this page
        </Text.Text>
    </Flex.Box>
    <Flex.Box direction="y" gap={2} className="on-this-page__content styled-scrollbar">
        <OTP
            client:only="react"
            headings={props.headings}
            url={props.url}
            clients={props.clients}
            platforms={props.platforms}
        />
    </Flex.Box>
    <Flex.Box direction="y" gap={2}>
        <Divider.Divider direction="x" />
        <Flex.Box direction="x" justify="end">
            <Feedback />
        </Flex.Box>
    </Flex.Box>
</Flex.Box>

<style is:global>
    nav.on-this-page {
        position: sticky;
        top: 22rem;
        width: 235px;
        align-self: flex-start;
        max-height: calc(100vh - 26rem);

        .on-this-page__header {
            flex-shrink: 0;

            & h5 {
                font-weight: 500;
            }
        }

        .on-this-page__content {
            flex: 1;
            min-height: 0;
            overflow-x: hidden;
            overflow-y: auto;
            padding-top: 2rem;
            padding-bottom: 2rem;
            mask-image: linear-gradient(
                to bottom,
                transparent 0,
                black 2rem,
                black calc(100% - 2rem),
                transparent 100%
            );
            -webkit-mask-image: linear-gradient(
                to bottom,
                transparent 0,
                black 2rem,
                black calc(100% - 2rem),
                transparent 100%
            );
        }

        .pluto-dialog {
            margin-bottom: 1rem;
        }

        flex-shrink: 0;

        .on-this-page-menu {
            position: relative;
        }

        .on-this-page-indicator {
            position: absolute;
            right: 0;
            width: 2px;
            background: var(--pluto-primary-z);
            transition:
                transform 0.25s cubic-bezier(0.4, 0, 0.2, 1),
                height 0.25s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.15s ease;
            pointer-events: none;
        }

        .on-this-page-item {
            display: block;
            padding: 1rem 2rem;
            font-size: var(--pluto-small-size);
            font-family: var(--pluto-font-family);
            color: var(--pluto-gray-l8);
            text-decoration: none;
            font-weight: 400;
            box-shadow: inset -1px 0 0 0 var(--pluto-border-color);
            transition:
                color 0.15s ease,
                font-weight 0.15s ease;

            &.depth-3 {
                padding-left: 4rem;
            }

            &:hover {
                color: var(--pluto-text-color);
            }

            &.active {
                color: var(--pluto-text-color);
                font-weight: 500;
            }
        }
    }
</style>
