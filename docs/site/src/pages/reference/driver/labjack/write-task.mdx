---
layout: "@/layouts/Reference.astro"
title: "LabJack Write Task"
description: "Learn how to use Write Tasks for LabJack hardware."
prev: "Read Task"
prevURL: "/reference/driver/labjack/read-task"
---

import { Divider, Note, Icon, Text } from "@synnaxlabs/pluto";
import { Video, Image } from "@/components/Media";
import { Fragment } from "react";
import ChannelTypeDetails from "@/components/details/ChannelTypeDetails.astro";
import ExampleDetails from "@/components/details/ExampleDetails.astro";
import { Client } from "@/components/client";
import { mdxOverrides } from "@/components/mdxOverrides";
export const components = mdxOverrides;

Sends control commands to analog and digital outputs on LabJack devices.

<Divider.Divider x />

## How Commands Work

Write tasks use **command** and **state** channels:

- **Command channels** (`_cmd`): Write values here to set outputs
- **State channels** (`_state`): Reflect the current output state
- **Command time channels** (`_cmd_time`): Index channels storing command timestamps

When you write to a command channel, the task processes it and updates the state channel, providing acknowledgment that the command was executed.

<Divider.Divider x />

## Task Configuration Reference

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `name` | string | Yes | - | Human-readable task name |
| `state_rate` | number | No | `20` | Rate (Hz) at which state channels are updated |
| `data_saving` | boolean | No | `false` | Enable permanent storage in Synnax |
| `auto_start` | boolean | No | `false` | Automatically start task after configuration |
| `channels` | array | Yes | - | List of output channel configurations |

<Divider.Divider x />

## Channel Types Reference

<ChannelTypeDetails>
<Text.Text slot="summary" level="p"><Icon.Wave.Sine /> Analog Output ([`AO`](https://support.labjack.com/docs/15-0-dac-t-series-datasheet))</Text.Text>

Writes analog voltage to a specified output terminal (DAC).

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `cmd_channel` | number | Yes | - | Synnax command channel key |
| `state_channel` | number | Yes | - | Synnax state channel key |
| `port` | string | Yes | - | Port location (e.g., `DAC0`, `DAC1`) |

</ChannelTypeDetails>

<ChannelTypeDetails>
<Text.Text slot="summary" level="p"><Icon.Wave.Square /> Digital Output ([`DO`](https://support.labjack.com/docs/13-0-digital-i-o-t-series-datasheet))</Text.Text>

Writes digital state (0 or 1) to a specified digital I/O line.

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `cmd_channel` | number | Yes | - | Synnax command channel key |
| `state_channel` | number | Yes | - | Synnax state channel key |
| `port` | string | Yes | - | Port location (e.g., `DIO4`, `FIO5`) |

</ChannelTypeDetails>

<Divider.Divider x />

## Important Rules

- **Command/State pairs**: Each output requires both a command and state channel
- **State rate**: Higher state rates provide faster feedback but consume more resources
- **One running task per channel**: A channel can only send commands to one task at a time

<Divider.Divider x />

## How To

<Client.Tabs client:only="react" exclude={["cpp"]}>
  <Fragment slot="console">
    <Video
      client:only="react"
      id="device-drivers/labjack/write-task/select-device"
    />
  </Fragment>
  <Fragment slot="python">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```python
import synnax as sy
from synnax.hardware import labjack

client = sy.Synnax()

# Retrieve device
dev = client.hardware.devices.retrieve(name="my_labjack")

# Create command time index
do_cmd_time = client.channels.create(
    name="do_cmd_time",
    is_index=True,
    data_type=sy.DataType.TIMESTAMP,
    retrieve_if_name_exists=True,
)

# Create command channel
do_4_cmd = client.channels.create(
    name="do_4_cmd",
    index=do_cmd_time.key,
    data_type=sy.DataType.UINT8,
    retrieve_if_name_exists=True,
)

# Create state time index
do_state_time = client.channels.create(
    name="do_state_time",
    is_index=True,
    data_type=sy.DataType.TIMESTAMP,
    retrieve_if_name_exists=True,
)

# Create state channel
do_4_state = client.channels.create(
    name="do_4_state",
    index=do_state_time.key,
    data_type=sy.DataType.UINT8,
    retrieve_if_name_exists=True,
)

# Create and configure task
task = labjack.WriteTask(
    name="LabJack Write",
    device=dev.key,
    state_rate=sy.Rate.HZ * 20,
    data_saving=True,
    channels=[
        labjack.OutputChan(
            type="DO",
            cmd_channel=do_4_cmd.key,
            state_channel=do_4_state.key,
            port="DIO4",
        ),
    ],
)

client.hardware.tasks.configure(task)

# Start task and write commands
with task.run():
    with client.open_writer(
        start=sy.TimeStamp.now(),
        channels=["do_4_cmd"],
    ) as writer:
        # Set output high
        writer.write({
            "do_4_cmd": 1,
        })

        # Read back state
        with client.open_streamer(["do_4_state"]) as streamer:
            frame = streamer.read()
            print(f"State: {frame['do_4_state'][-1]}")

        # Set output low
        writer.write({
            "do_4_cmd": 0,
        })
```

</ExampleDetails>
<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```python
# Retrieve existing task
task = client.hardware.tasks.retrieve(name="LabJack Write")

# Modify configuration
task.config.state_rate = 50

# Add a new channel
new_cmd_channel = client.channels.create(
    name="do_5_cmd",
    index=do_cmd_time.key,
    data_type=sy.DataType.UINT8,
    retrieve_if_name_exists=True,
)

new_state_channel = client.channels.create(
    name="do_5_state",
    index=do_state_time.key,
    data_type=sy.DataType.UINT8,
    retrieve_if_name_exists=True,
)

task.config.channels.append(
    labjack.OutputChan(
        type="DO",
        cmd_channel=new_cmd_channel.key,
        state_channel=new_state_channel.key,
        port="DIO5",
    )
)

# Reconfigure task
client.hardware.tasks.configure(task)
```

</ExampleDetails>

  </Fragment>
  <Fragment slot="typescript">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```typescript
import { Synnax, TimeStamp, Rate } from "@synnaxlabs/client";

const client = new Synnax();

// Retrieve device
const dev = await client.hardware.devices.retrieve({ name: "my_labjack" });

// Create command time index
const doCmdTime = await client.channels.create({
  name: "do_cmd_time",
  isIndex: true,
  dataType: "timestamp",
  retrieveIfNameExists: true,
});

// Create command channel
const do4Cmd = await client.channels.create({
  name: "do_4_cmd",
  index: doCmdTime.key,
  dataType: "uint8",
  retrieveIfNameExists: true,
});

// Create state time index
const doStateTime = await client.channels.create({
  name: "do_state_time",
  isIndex: true,
  dataType: "timestamp",
  retrieveIfNameExists: true,
});

// Create state channel
const do4State = await client.channels.create({
  name: "do_4_state",
  index: doStateTime.key,
  dataType: "uint8",
  retrieveIfNameExists: true,
});

// Create and configure task
const task = await client.hardware.tasks.create({
  name: "LabJack Write",
  type: "labjack_write",
  config: JSON.stringify({
    device: dev.key,
    state_rate: 20,
    data_saving: true,
    channels: [
      {
        type: "DO",
        cmd_channel: do4Cmd.key,
        state_channel: do4State.key,
        port: "DIO4",
      },
    ],
  }),
});

// Start task
await task.executeCommandSync("start");

// Write command
const writer = await client.openWriter({
  start: TimeStamp.now(),
  channels: ["do_4_cmd"],
});

// Set output high
await writer.write({
  "do_4_cmd": 1,
});

// Read state
const streamer = await client.openStreamer(["do_4_state"]);
const frame = await streamer.read();
console.log(`State: ${frame["do_4_state"]}`);

// Set output low
await writer.write({
  "do_4_cmd": 0,
});

// Stop task
await task.executeCommandSync("stop");
await writer.close();
await streamer.close();
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```typescript
// Retrieve existing task
const task = await client.hardware.tasks.retrieve({ name: "LabJack Write" });

// Parse current configuration
const config = JSON.parse(task.config);

// Modify configuration
config.state_rate = 50;

// Add a new channel
const newCmdChannel = await client.channels.create({
  name: "do_5_cmd",
  index: doCmdTime.key,
  dataType: "uint8",
  retrieveIfNameExists: true,
});

const newStateChannel = await client.channels.create({
  name: "do_5_state",
  index: doStateTime.key,
  dataType: "uint8",
  retrieveIfNameExists: true,
});

config.channels.push({
  type: "DO",
  cmd_channel: newCmdChannel.key,
  state_channel: newStateChannel.key,
  port: "DIO5",
});

// Update task configuration
task.config = JSON.stringify(config);
await client.hardware.tasks.create(task);
```

</ExampleDetails>

  </Fragment>
</Client.Tabs>

For task lifecycle management, see the [Task Basics](/reference/driver/task-basics#how-to) page.
