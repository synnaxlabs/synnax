---
layout: "@/layouts/Reference.astro"
title: "NI Counter Write Task"
description: "Learn how to use Counter Write Tasks for NI hardware."
next: "Digital Read Task"
nextURL: "/reference/driver/ni/digital-read-task"
prev: "Counter Read Task"
prevURL: "/reference/driver/ni/counter-read-task"
---

import { Divider, Note, Icon, Text } from "@synnaxlabs/pluto";
import { Video, Image } from "@/components/Media";
import { Fragment } from "react";
import { Client } from "@/components/client";
import ExampleDetails from "@/components/details/ExampleDetails.astro";
import { mdxOverrides } from "@/components/mdxOverrides";
export const components = mdxOverrides;

Generates pulse train outputs on counter channels for NI devices.

<Divider.Divider x />

<Note.Note variant="warning">
**Configuration Only**: Counter write tasks are configuration-only. Once configured and started, the task will continuously generate the specified pulse train based on the parameters set during configuration. No command or state channels are created, and the pulse output cannot be modified at runtime without reconfiguring the task.
</Note.Note>

<Divider.Divider x />

## Task Configuration Reference

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `name` | string | Yes | - | Human-readable task name |
| `auto_start` | boolean | No | `false` | Automatically start task after configuration |
| `channels` | array | Yes | - | List of counter output channel configurations |

<Divider.Divider x />

## Channel Configuration
[Pulse Output NI-DAQmx C API Reference](https://www.ni.com/docs/en-US/bundle/ni-daqmx-c-api-ref/page/daqmxcfunc/daqmxcreatecopulsechantime.html)

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `device` | string | Yes | - | Device identifier |
| `port` | number | Yes | - | Counter port (0-indexed) |
| `idle_state` | enum | No | `Low` | `Low`, `High` - output level when idle |
| `initial_delay` | number | No | `0` | Delay before first pulse (seconds) |
| `high_time` | number | No | `1e-6` | Duration of high portion of pulse (seconds) |
| `low_time` | number | No | `1e-6` | Duration of low portion of pulse (seconds) |

<Divider.Divider x />

## Important Rules

- **Configuration only**: Pulse parameters are set once when the task is configured and cannot be changed at runtime
- **No command/state channels**: Unlike other write tasks, counter write tasks do not create or use command and state channels
- **One task per module**: Only one running task can claim a module at a time
- **Continuous output**: Once started, the task generates pulses continuously until stopped
- **Port validation**: Counter ports cannot be duplicated within the same task

<Divider.Divider x />

## How To

<Client.Tabs client:only="react">
  <Fragment slot="console">
    <Video
      client:only="react"
      id="device-drivers/ni/counter-write-task/counter-write-task-select-device"
    />
  </Fragment>
  <Fragment slot="python">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```python
import synnax as sy
from synnax.hardware import ni

client = sy.Synnax()

# Retrieve device
dev = client.hardware.devices.retrieve(name="my_daq")

# Create and configure task
# Note: No channels need to be created - task is configuration-only
task = ni.CounterWriteTask(
    name="Counter Write",
    channels=[
        ni.COPulseOutputChan(
            device=dev.key,
            port=0,
            idle_state="Low",
            initial_delay=0.0,
            high_time=0.001,  # 1ms high
            low_time=0.001,   # 1ms low (500Hz pulse train)
        ),
    ],
)

client.hardware.tasks.configure(task)

# Start task - pulse train begins immediately
with task.run():
    # Task is now generating continuous 500Hz pulses on counter 0
    # No commands to send - output is fixed at configuration time
    sy.sleep(5)  # Let it run for 5 seconds

# Task stops when exiting context
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Details /> List All Tasks & Retrieve by Name</Text.Text>

```python
import synnax as sy
from synnax.hardware import ni

client = sy.Synnax()

# List all tasks
all_tasks = client.hardware.tasks.list()
for task in all_tasks:
    print(f"Task: {task.name}, Type: {task.type}")

# Retrieve task by name
task = client.hardware.tasks.retrieve(name="Counter Write")

# List all counter write tasks
counter_write_tasks = [t for t in all_tasks if t.type == "ni_counter_write"]
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```python
# TODO: Add example for editing task configuration
# - Update task parameters (name, auto_start, etc.)
# - Modify channel parameters (high_time, low_time, etc.)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Copy /> Copy Task</Text.Text>

```python
# TODO: Add example for copying a task
# - Copy task with new name
# - Preserve channel configuration
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Close /> Stop and Delete Task</Text.Text>

```python
import synnax as sy

client = sy.Synnax()

# Retrieve task
task = client.hardware.tasks.retrieve(name="Counter Write")

# Stop task if running
task.stop()

# Delete task
client.hardware.tasks.delete(task.key)
```

</ExampleDetails>

  </Fragment>
  <Fragment slot="typescript">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```typescript
import { Synnax, TimeSpan } from "@synnaxlabs/client";
import { sleep } from "@synnaxlabs/x";

const client = new Synnax();

// Retrieve device
const dev = await client.hardware.devices.retrieve({ name: "my_daq" });

// Create and configure task
// Note: No channels need to be created - task is configuration-only
const task = await client.hardware.tasks.create({
  name: "Counter Write",
  type: "ni_counter_write",
  config: JSON.stringify({
    channels: [
      {
        type: "co_pulse_output",
        device: dev.key,
        port: 0,
        idle_state: "Low",
        initial_delay: 0.0,
        high_time: 0.001, // 1ms high
        low_time: 0.001, // 1ms low (500Hz pulse train)
        units: "Seconds",
      },
    ],
  }),
});

// Start task - pulse train begins immediately
await task.executeCommandSync("start");

// Task is now generating continuous 500Hz pulses on counter 0
// No commands to send - output is fixed at configuration time

// Wait 5 seconds
await sleep.sleep(TimeSpan.seconds(5));

// Stop task
await task.executeCommandSync("stop");
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Details /> List All Tasks & Retrieve by Name</Text.Text>

```typescript
import { Synnax } from "@synnaxlabs/client";

const client = new Synnax();

// List all tasks
const allTasks = await client.hardware.tasks.list();
allTasks.forEach(task => {
  console.log(`Task: ${task.name}, Type: ${task.type}`);
});

// Retrieve task by name
const task = await client.hardware.tasks.retrieve({ name: "Counter Write" });

// List all counter write tasks
const counterWriteTasks = allTasks.filter(t => t.type === "ni_counter_write");
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```typescript
// TODO: Add example for editing task configuration
// - Update task parameters (name, auto_start, etc.)
// - Modify channel parameters (high_time, low_time, etc.)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Copy /> Copy Task</Text.Text>

```typescript
// TODO: Add example for copying a task
// - Copy task with new name
// - Preserve channel configuration
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Close /> Stop and Delete Task</Text.Text>

```typescript
import { Synnax } from "@synnaxlabs/client";

const client = new Synnax();

// Retrieve task
const task = await client.hardware.tasks.retrieve({ name: "Counter Write" });

// Stop task if running
await task.executeCommandSync("stop");

// Delete task
await client.hardware.tasks.delete(task.key);
```

</ExampleDetails>

  </Fragment>
  <Fragment slot="cpp">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```cpp
#include "client/cpp/synnax.h"
#include <thread>
#include <chrono>

auto client = synnax::Synnax();

// Retrieve device
auto [dev, dev_err] = client.hardware.retrieve_device("my_daq");
if (dev_err) return dev_err;

// Create and configure task
// Note: No channels need to be created - task is configuration-only
// (Task configuration in C++ typically done via driver directly)

// Start task - pulse train begins immediately
// Task is now generating continuous 500Hz pulses on counter 0
// No commands to send - output is fixed at configuration time

// Wait 5 seconds
std::this_thread::sleep_for(std::chrono::seconds(5));

// Task stops when program exits or driver shuts down
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Details /> List All Tasks & Retrieve by Name</Text.Text>

```cpp
#include "client/cpp/synnax.h"

auto client = synnax::Synnax();

// Create or retrieve rack
auto [rack, rack_err] = client.hardware.retrieve_rack("my_rack");
if (rack_err) return rack_err;

// List all tasks
auto [tasks, list_err] = rack.tasks.list();
if (list_err) return list_err;

for (const auto& task : tasks) {
    std::cout << "Task: " << task.name << ", Type: " << task.type << std::endl;
}

// Retrieve task by name
auto [task, retrieve_err] = rack.tasks.retrieve("Counter Write");
if (retrieve_err) return retrieve_err;

// List all counter write tasks
std::vector<synnax::Task> counter_write_tasks;
for (const auto& t : tasks) {
    if (t.type == "ni_counter_write") {
        counter_write_tasks.push_back(t);
    }
}
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```cpp
// TODO: Add example for editing task configuration
// - Update task parameters (name, auto_start, etc.)
// - Modify channel parameters (high_time, low_time, etc.)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Copy /> Copy Task</Text.Text>

```cpp
// TODO: Add example for copying a task
// - Copy task with new name
// - Preserve channel configuration
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Close /> Stop and Delete Task</Text.Text>

```cpp
#include "client/cpp/synnax.h"

auto client = synnax::Synnax();

// Retrieve rack
auto [rack, rack_err] = client.hardware.retrieve_rack("my_rack");
if (rack_err) return rack_err;

// Retrieve task
auto [task, task_err] = rack.tasks.retrieve("Counter Write");
if (task_err) return task_err;

// Stop task if running
// (Note: Stopping tasks typically handled via driver commands)

// Delete task
// (Note: Task deletion handled through rack.tasks operations)
```

</ExampleDetails>

  </Fragment>
</Client.Tabs>
