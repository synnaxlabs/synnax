---
layout: "@/layouts/Reference.astro"
title: "NI Digital Write Task"
description: "Learn how to use Digital Write Tasks for NI hardware."
prev: "Digital Read Task"
prevURL: "/reference/driver/ni/digital-read-task"
---

import { Divider, Note, Icon, Text } from "@synnaxlabs/pluto";
import { Video, Image } from "@/components/Media";
import { Fragment } from "react";
import ExampleDetails from "@/components/details/ExampleDetails.astro";
import { Client } from "@/components/client";
import { mdxOverrides } from "@/components/mdxOverrides";
export const components = mdxOverrides;

Sends control commands to digital outputs on NI devices.

<Divider.Divider x />

## How Commands Work

Write tasks use **command** and **state** channels:

- **Command channels** (`_cmd`): Write values here to set digital outputs (1 = high, 0 = low)
- **State channels** (`_state`): Reflect the current output state
- **Command time channels** (`_cmd_time`): Index channels storing command timestamps

When you write to a command channel, the task processes it and updates the state channel, providing acknowledgment that the command was executed.

<Divider.Divider x />

## Task Configuration Reference

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `name` | string | Yes | - | Human-readable task name |
| `state_rate` | number | No | `20` | Rate (Hz) at which state channels are updated |
| `data_saving` | boolean | No | `false` | Enable permanent storage in Synnax |
| `auto_start` | boolean | No | `false` | Automatically start task after configuration |
| `channels` | array | Yes | - | List of digital output channel configurations |

<Divider.Divider x />

## Channel Configuration
[DO Channel NI-DAQmx C API Reference](https://www.ni.com/docs/en-US/bundle/ni-daqmx-c-api-ref/page/daqmxcfunc/daqmxcreatedochan.html)

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `device` | string | Yes | - | Device identifier |
| `port` | number | Yes | - | Physical port |
| `line` | number | Yes | - | Line number on the port |

<Divider.Divider x />

## Important Rules

- **Command/State pairs**: Each digital output requires both a command and state channel
- **One task per module**: Only one running task can claim a module at a time.
- **State rate**: Higher state rates provide faster feedback but consume more resources

<Divider.Divider x />

## How To

<Client.Tabs client:only="react">
  <Fragment slot="console">
    <Video
      client:only="react"
      id="device-drivers/ni/digital-write-task/digital-write-task-select-device"
    />
  </Fragment>
  <Fragment slot="python">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```python
import synnax as sy
from synnax.hardware import ni

client = sy.Synnax()

# Retrieve device
dev = client.hardware.devices.retrieve(name="my_daq")

# Create command time index
do_cmd_time = client.channels.create(
    name="do_cmd_time",
    is_index=True,
    data_type=sy.DataType.TIMESTAMP,
    retrieve_if_name_exists=True,
)

# Create command channel
do_0_0_cmd = client.channels.create(
    name="do_0_0_cmd",
    index=do_cmd_time.key,
    data_type=sy.DataType.UINT8,
    retrieve_if_name_exists=True,
)

# Create state time index
do_state_time = client.channels.create(
    name="do_state_time",
    is_index=True,
    data_type=sy.DataType.TIMESTAMP,
    retrieve_if_name_exists=True,
)

# Create state channel
do_0_0_state = client.channels.create(
    name="do_0_0_state",
    index=do_state_time.key,
    data_type=sy.DataType.UINT8,
    retrieve_if_name_exists=True,
)

# Create and configure task
task = ni.DigitalWriteTask(
    name="Digital Write",
    state_rate=sy.Rate.HZ * 20,
    data_saving=True,
    channels=[
        ni.DOLineChan(
            cmd_channel=do_0_0_cmd.key,
            state_channel=do_0_0_state.key,
            device=dev.key,
            port=0,
            line=0,
        ),
    ],
)

client.hardware.tasks.configure(task)

# Start task and write commands
with task.run():
    with client.open_writer(
        start=sy.TimeStamp.now(),
        channels=["do_0_0_cmd"],
    ) as writer:
        # Set output high
        writer.write({
            "do_0_0_cmd": 1,
        })

        # Read back state
        with client.open_streamer(["do_0_0_state"]) as streamer:
            frame = streamer.read()
            print(f"State: {frame['do_0_0_state']}")
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Details /> List All Tasks & Retrieve by Name</Text.Text>

```python
import synnax as sy

client = sy.Synnax()

# List all tasks
all_tasks = client.hardware.tasks.list()
for task in all_tasks:
    print(f"Task: {task.name}, Type: {task.type}")

# Retrieve task by name
task = client.hardware.tasks.retrieve(name="Digital Write")

# List all digital write tasks
digital_write_tasks = [t for t in all_tasks if t.type == "ni_digital_write"]
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```python
# TODO: Add example for editing task configuration
# - Update task parameters (state_rate, data_saving, etc.)
# - Modify channel parameters (port, line, etc.)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Copy /> Copy Task</Text.Text>

```python
# TODO: Add example for copying a task
# - Copy task with new name
# - Preserve channel configuration
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Close /> Stop and Delete Task</Text.Text>

```python
import synnax as sy

client = sy.Synnax()

# Retrieve task
task = client.hardware.tasks.retrieve(name="Digital Write")

# Stop task if running
task.stop()

# Delete task
client.hardware.tasks.delete(task.key)
```

</ExampleDetails>

  </Fragment>
  <Fragment slot="typescript">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```typescript
import { Synnax, TimeStamp } from "@synnaxlabs/client";

const client = new Synnax();

// Retrieve device
const dev = await client.hardware.devices.retrieve({ name: "my_daq" });

// Create command time index
const doCmdTime = await client.channels.create({
  name: "do_cmd_time",
  isIndex: true,
  dataType: "timestamp",
  retrieveIfNameExists: true,
});

// Create command channel
const do00Cmd = await client.channels.create({
  name: "do_0_0_cmd",
  index: doCmdTime.key,
  dataType: "uint8",
  retrieveIfNameExists: true,
});

// Create state time index
const doStateTime = await client.channels.create({
  name: "do_state_time",
  isIndex: true,
  dataType: "timestamp",
  retrieveIfNameExists: true,
});

// Create state channel
const do00State = await client.channels.create({
  name: "do_0_0_state",
  index: doStateTime.key,
  dataType: "uint8",
  retrieveIfNameExists: true,
});

// Create and configure task
const task = await client.hardware.tasks.create({
  name: "Digital Write",
  type: "ni_digital_write",
  config: JSON.stringify({
    state_rate: 20,
    data_saving: true,
    channels: [
      {
        type: "do_line",
        cmd_channel: do00Cmd.key,
        state_channel: do00State.key,
        device: dev.key,
        port: 0,
        line: 0,
      },
    ],
  }),
});

// Start task
await task.executeCommandSync("start");

// Write command
const writer = await client.openWriter({
  start: TimeStamp.now(),
  channels: ["do_0_0_cmd"],
});

await writer.write({
  "do_0_0_cmd": 1, // Set high
});

// Read state
const streamer = await client.openStreamer(["do_0_0_state"]);
const frame = await streamer.read();
console.log(`State: ${frame["do_0_0_state"]}`);

// Stop task
await task.executeCommandSync("stop");
await writer.close();
await streamer.close();
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Details /> List All Tasks & Retrieve by Name</Text.Text>

```typescript
import { Synnax } from "@synnaxlabs/client";

const client = new Synnax();

// List all tasks
const allTasks = await client.hardware.tasks.list();
allTasks.forEach(task => {
  console.log(`Task: ${task.name}, Type: ${task.type}`);
});

// Retrieve task by name
const task = await client.hardware.tasks.retrieve({ name: "Digital Write" });

// List all digital write tasks
const digitalWriteTasks = allTasks.filter(t => t.type === "ni_digital_write");
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```typescript
// TODO: Add example for editing task configuration
// - Update task parameters (state_rate, data_saving, etc.)
// - Modify channel parameters (port, line, etc.)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Copy /> Copy Task</Text.Text>

```typescript
// TODO: Add example for copying a task
// - Copy task with new name
// - Preserve channel configuration
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Close /> Stop and Delete Task</Text.Text>

```typescript
import { Synnax } from "@synnaxlabs/client";

const client = new Synnax();

// Retrieve task
const task = await client.hardware.tasks.retrieve({ name: "Digital Write" });

// Stop task if running
await task.executeCommandSync("stop");

// Delete task
await client.hardware.tasks.delete(task.key);
```

</ExampleDetails>

  </Fragment>
  <Fragment slot="cpp">

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Play /> Configure and Run Task</Text.Text>

```cpp
#include "client/cpp/synnax.h"

auto client = synnax::Synnax();

// Retrieve device
auto [dev, dev_err] = client.hardware.retrieve_device("my_daq");
if (dev_err) return dev_err;

// Create command time index
auto do_cmd_time = synnax::Channel("do_cmd_time", telem::TIMESTAMP_T, true);
auto cmd_time_err = client.channels.create(do_cmd_time);
if (cmd_time_err) return cmd_time_err;

// Create command channel
auto do_0_0_cmd = synnax::Channel("do_0_0_cmd", telem::UINT8_T, do_cmd_time.key, false);
auto cmd_err = client.channels.create(do_0_0_cmd);
if (cmd_err) return cmd_err;

// Create state time index
auto do_state_time = synnax::Channel("do_state_time", telem::TIMESTAMP_T, true);
auto state_time_err = client.channels.create(do_state_time);
if (state_time_err) return state_time_err;

// Create state channel
auto do_0_0_state = synnax::Channel("do_0_0_state", telem::UINT8_T, do_state_time.key, false);
auto state_err = client.channels.create(do_0_0_state);
if (state_err) return state_err;

// Create and configure task
// (Note: Task configuration in C++ typically done via driver directly)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Details /> List All Tasks & Retrieve by Name</Text.Text>

```cpp
#include "client/cpp/synnax.h"

auto client = synnax::Synnax();

// Create or retrieve rack
auto [rack, rack_err] = client.hardware.retrieve_rack("my_rack");
if (rack_err) return rack_err;

// List all tasks
auto [tasks, list_err] = rack.tasks.list();
if (list_err) return list_err;

for (const auto& task : tasks) {
    std::cout << "Task: " << task.name << ", Type: " << task.type << std::endl;
}

// Retrieve task by name
auto [task, retrieve_err] = rack.tasks.retrieve("Digital Write");
if (retrieve_err) return retrieve_err;

// List all digital write tasks
std::vector<synnax::Task> digital_write_tasks;
for (const auto& t : tasks) {
    if (t.type == "ni_digital_write") {
        digital_write_tasks.push_back(t);
    }
}
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Edit /> Edit Task Configuration</Text.Text>

```cpp
// TODO: Add example for editing task configuration
// - Update task parameters (state_rate, data_saving, etc.)
// - Modify channel parameters (port, line, etc.)
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Copy /> Copy Task</Text.Text>

```cpp
// TODO: Add example for copying a task
// - Copy task with new name
// - Preserve channel configuration
```

</ExampleDetails>

<ExampleDetails>
<Text.Text slot="summary" level="p"><Icon.Close /> Stop and Delete Task</Text.Text>

```cpp
#include "client/cpp/synnax.h"

auto client = synnax::Synnax();

// Retrieve rack
auto [rack, rack_err] = client.hardware.retrieve_rack("my_rack");
if (rack_err) return rack_err;

// Retrieve task
auto [task, task_err] = rack.tasks.retrieve("Digital Write");
if (task_err) return task_err;

// Stop task if running
// (Note: Stopping tasks typically handled via driver commands)

// Delete task
// (Note: Task deletion handled through rack.tasks operations)
```

</ExampleDetails>

  </Fragment>
</Client.Tabs>

