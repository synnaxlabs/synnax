syntax = "proto3";

package arc.v1.ir;

option go_package = "github.com/synnaxlabs/arc/ir";

import "arc/go/types/types.proto";
import "arc/go/symbol/symbol.proto";

message PBHandle {
    string node = 1;
    string param = 2;
}

message PBEdge {
    PBHandle source = 1;
    PBHandle target = 2;
}

message PBBody {
    string raw = 1;
}

message PBFunction {
    string key = 1;
    PBBody body = 2;
    repeated types.PBParam config = 3;
    repeated types.PBParam inputs = 4;
    repeated types.PBParam outputs = 5;
    symbol.PBChannels channels = 6;
}

message PBStratum {
    repeated string nodes = 1;
}

message PBNode {
    string key = 1;
    string type = 2;
    repeated types.PBParam config = 3;
    repeated types.PBParam inputs = 4;
    repeated types.PBParam outputs = 5;
    symbol.PBChannels channels = 6;
}

message PBIR {
    repeated PBFunction functions = 1;
    repeated PBNode nodes = 2;
    repeated PBEdge edges = 3;
    repeated PBStratum strata = 4;
}
